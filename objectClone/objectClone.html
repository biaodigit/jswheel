<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script>
    const isType = (obj, type) => {
        if (typeof obj !== 'object') return false;

        const typeString = Object.prototype.toString.call(obj);

        let flag;

        switch (type) {
            case 'Array':
                flag = typeString === '[object Array]';
                break;
            case 'Date':
                flag = typeString === '[object Date]';
                break;
            case 'RegExp':
                flag = typeString === '[object RegExp]';
                break;
            default:
                flag = false
        }

        return flag
    };

    const getRegExp = (reg) => {
        let flags = '';

        if (reg.global) flags += 'g';

        if (reg.ignoreCase) flags += 'i';

        if (reg.multiline) flags += 'm';

        return flags
    };

    const deepClone = (parent) => {
        const parents = [];
        const children = [];

        const _clone = (parent) => {
            if (parent === null) return null;

            if (typeof parent !== 'object') return parent;

            let child, proto;

            if (isType(parent, 'Array')) {
                child = []
            } else if (isType(parent, 'RegExp')) {
                child = new RegExp(parent.source, getRegExp(parent));

                if (parent.lastIndex) child.lastIndex = parent.lastIndex
            } else if (isType(parent, 'Date')) {
                child = new Date(parent.getTime())
            } else {
                proto = Object.getPrototypeOf(parent);
                child = Object.create(proto);
            }

            const index = parents.indexOf(parent);

            //处理循环引用
            if (index !== -1) {
                return children[index]
            }

            parents.push(parent);
            children.push(child);

            for (let obj in parent) {
                if (parent.hasOwnProperty(obj)) {
                    child[obj] = _clone(parent[obj])
                }
            }

            return child

        };

        return _clone(parent)
    };


</script>
</body>
</html>